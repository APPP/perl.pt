
# Excepções em Perl

 2011-02-06, por Alberto Simões <ambs@cpan.org>

<img alt="Newbie Icon" src="%%BASE_URI%%imgs/babycammel.png" class="mt-image-right" style="float: right; margin: 0pt 0pt 20px 20px;" height="171" width="170" />
     <div>Até há relativamente pouco tempo, a falta de tratamento adequado de erros e excepções era uma razão para muitos programadores <a class="zem_slink" href="http://www.perl.org/" title="Perl" rel="homepage">Perl</a> o abandonarem noutras direcções. Na verdade, não é simpático que determinado código ao falhar retorne apenas um valor indefenido (<i>undef</i>) sem indicar claramente qual o erro ocorrido.<br /><br />Desde 2009 (pelo menos), que está disponível um pequeno módulo, chamado <a href="http://search.cpan.org/dist/Try-Tiny"><i>Try::Tiny</i></a>,&nbsp; que torna muito simples a implementação de código com excepções. Simples, e intuitiva.<br /><br />Então, qual a filosofia? Quando determinada função ou bloco de código falha deve invocar a função <i>die</i> com a mensagem de erro em causa. Este <i>die</i> vai ser entendido pelo <i>Try::Tiny</i> como o levantamento da excepção, e que poderá ser apanhado com um bloco try, como vamos ver no exemplo abaixo.<br /><br />Considerem uma função que realiza uma divisão de dois valores:<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sub divide {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; my ($dividendo, $divisor) = @_;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($divisor == 0) {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; die "Erro! Divisão por zero!";<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $dividendo / $divisor;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /><br />Quando o divisor for o valor zero um erro é despoletado. Sem o uso do <i>Try::Tiny</i> o código apresentado iria abordar todas as execuções em que se tentase realizar a divisão por zero. Mas, com este módulo, podemos apanhar essa excepção:<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; use Try::Tiny;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; my $resultado = divide(10, 0);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; print "O resultado da divisão é: $resultado";<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } catch {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; print "Ocorreu um erro: $_"; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; };<br /><br />Este módulo permite mais algumas brincadeiras que veremos num post seguinte.<br /></div>

<div style="margin-top: 10px; height: 15px;" class="zemanta-pixie"><a class="zemanta-pixie-a" href="http://www.zemanta.com/" title="Enhanced by Zemanta"><img style="border: medium none; float: right;" class="zemanta-pixie-img" src="http://img.zemanta.com/zemified_e.png?x-id=2a107616-3bb9-4c53-a586-ffa06f6f5d0c" alt="Enhanced by Zemanta" /></a></div>
